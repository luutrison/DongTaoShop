@using DongTaoShop.Models;
@{
    ViewBag.Title = "Đơn hàng của bạn | Đông Tảo Shop - Chợ nông sản online của người Việt";
    Layout = "~/Views/Shared/_Layout.cshtml";

    List<DonHang> list = ViewBag.DonHang;
    TaiKhoan user = ViewBag.User;
    var token = Session["UserToken"];
    
}

<section class="d-flex justify-content-center" style="position: relative;">
    <div style="width: 100%;max-width: 1200px;"><img class="banner-shop" src="../../assets/img/banner.png" style="width: 100%;"></div>
</section>
<section class="d-xl-flex justify-content-xl-center" style="min-height: 700px;">
    <div class="row row-cols-1 row-cols-lg-2" style="max-width: 1200px;width: 100%;margin: 0px;position: relative;padding-top: 40px;padding-bottom: 40px;background: #ffffff;">
        <div class="col-lg-3 col-xl-3 nav-account-pc" style="transition: .5s;z-index: 8;">
            <div class="row row-cols-1" style="background: rgb(255,255,255);overflow: hidden;box-shadow: inset 0px 0px 5px rgb(0,129,82);margin: 0px;position: sticky;top: 20%;border: 3px solid rgb(33,149,57);">
                <div class="col col-slidermain " style="border-top: 1px dotted rgb(0,0,0) ;">
                    <div class="row row-cols-2" style="padding-top: 15px;padding-bottom: 15px;">
                        <div class="col-3 col-lg-4 col-xl-3 d-flex justify-content-center align-items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" style="font-size: 30px;">
                                <path d="M7 18H17V16H7V18Z" fill="currentColor"></path>
                                <path d="M17 14H7V12H17V14Z" fill="currentColor"></path>
                                <path d="M7 10H11V8H7V10Z" fill="currentColor"></path>
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M6 2C4.34315 2 3 3.34315 3 5V19C3 20.6569 4.34315 22 6 22H18C19.6569 22 21 20.6569 21 19V9C21 5.13401 17.866 2 14 2H6ZM6 4H13V9H19V19C19 19.5523 18.5523 20 18 20H6C5.44772 20 5 19.5523 5 19V5C5 4.44772 5.44772 4 6 4ZM15 4.10002C16.6113 4.4271 17.9413 5.52906 18.584 7H15V4.10002Z" fill="currentColor"></path>
                            </svg>
                        </div>
                        <div class="col-auto d-lg-flex d-xl-flex align-items-lg-center align-items-xl-center" style="font-size: 20px;"><span style="font-weight: bold;">Hồ sơ</span></div>
                    </div><a href="/account/userprofile" style="position: absolute;top: 0;left: 0;width: 100%;height: 100%;"></a>
                </div>
                <div class="col col-slidermain active-account-menu" style="border-top-width: 1px;border-top-style: dotted;">
                    <div class="row" style="padding-top: 15px;padding-bottom: 15px;">
                        <div class="col-3 col-lg-4 col-xl-3 d-flex justify-content-center"><i class="fas fa-shipping-fast" style="font-size: 26px;"></i></div>
                        <div class="col-auto d-lg-flex d-xl-flex align-items-lg-center align-items-xl-center" style="font-size: 20px;"><span style="font-weight: bold;">Đơn hàng</span></div>
                    </div><a href="/account/order" style="position: absolute;top: 0;left: 0;width: 100%;height: 100%;"></a>
                </div>
                @if (user.Admin == true)
                {
                    <div class="col col-slidermain" style="border-top-width: 1px;border-top-style: dotted;">
                        <div class="row" style="padding-top: 15px;padding-bottom: 15px;">
                            <div class="col-3 col-lg-4 col-xl-3 d-flex justify-content-center"><i class="fas fa-door-open" style="font-size: 28px;"></i></div>
                            <div class="col-auto d-lg-flex d-xl-flex align-items-lg-center align-items-xl-center" style="font-size: 20px;"><span style="font-weight: bold;">Quản lý</span></div>
                        </div><a href="/admin" style="position: absolute;top: 0;left: 0;width: 100%;height: 100%;"></a>
                    </div>
                }
                <div class="col col-logout" style="border-top-width: 1px;border-top-style: dotted;">
                    <div class="row" style="padding-top: 15px;padding-bottom: 15px;">
                        <div class="col-3 col-lg-4 col-xl-3 d-flex justify-content-center">
                            <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icon-tabler-logout" style="font-size: 37px;">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path d="M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2"></path>
                                <path d="M7 12h14l-3 -3m0 6l3 -3"></path>
                            </svg>
                        </div>
                        <div class="col-auto d-lg-flex d-xl-flex align-items-lg-center align-items-xl-center" style="font-size: 20px;"><span style="font-weight: bold;">Đăng xuất</span></div>
                    </div><a href="/account/logout" style="position: absolute;top: 0;left: 0;width: 100%;height: 100%;"></a>
                </div>
            </div>
        </div>
        <div class="col-lg-9 col-xl-9 content-account-user" style="padding: 5px;border-style: solid;border-color: rgb(0,129,82);">
            <form>
                <div class="form-row row-cols-1" style="margin: 0px;">

                    <div class="col">
                        <div class="form-row row-cols-1">
                            <div class="col d-flex justify-content-start justify-content-lg-start" style="padding-bottom: 15px;padding-top: 15px;margin-bottom: 15px;background: #008152;">
                                <div class="row" style="width: 100%;">
                                    <div class="col-7 d-flex align-items-center justify-content-lg-center" style="padding-left: 15px;"><span class="text-uppercase" style="font-size: 22px;font-weight: bold;color: rgb(255,255,255);">Đơn hàng</span></div>
                                    <div class="col-5 d-flex justify-content-end col-btn-show-menu-account" onclick="showNavAccount()">
                                        <div class="row">
                                            <div class="col d-flex d-sm-flex align-items-center align-items-sm-center"><span class="text-uppercase" style="font-weight: bold;color: rgb(255,255,255);font-size: 22px;">Menu</span><i class="material-icons" style="color: rgb(255,255,255);">menu</i></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    @foreach (var item in list)
                    {
                        var ngay = item.NgayDat?.ToString("dd/MM/yyy");
                        <div class="col" style="overflow: hidden;border: 2px solid rgb(5,82,36);margin-bottom: 30px;padding: 0px;background: #ffffff;">
                            <div class="form-row row-cols-1 row-cols-sm-1 row-cols-md-1 row-cols-lg-1 row-cols-xl-2">
                                <div class="col-lg-10 col-xl-11 d-lg-flex d-xl-flex align-items-lg-center align-items-xl-center" style="padding: 10px;padding-right: 20px;padding-left: 20px;">
                                    <div class="form-row row-cols-1 row-cols-sm-1 row-cols-md-3 row-cols-lg-3 row-cols-xl-3">
                                        <div class="col-md-2 col-lg-2 col-xl-2 d-flex justify-content-center col-imgorder-admin">
                                            <div class="form-row row-cols-2 row-cols-md-1" style="width: 100%;">
                                                <div class="col d-flex justify-content-center">
                                                    <div style="width: 40px;height: 40px;background: url(&quot;../../@item.SanPham.Anh&quot;) center / cover no-repeat;border-radius: 50px;"></div>
                                                </div>
                                                <div class="col d-flex justify-content-center align-items-center"><span><strong>DH-@item.Id</strong></span></div>
                                                <div class="col d-flex justify-content-center align-items-center"><span><strong>@ngay</strong></span></div>
                                            </div>
                                        </div>
                                        <div class="col-md-5 col-lg-5 col-xl-5 d-flex align-items-center">
                                            <div class="form-row row-cols-1">
                                                <div class="col"><span>Tên sản phẩm: <strong>@item.SanPham.Ten</strong></span></div>
                                                <div class="col"><span>Số lượng: <strong>@item.SoLuong</strong></span></div>
                                                <div class="col"><span>Thành tiền:&nbsp;</span><span class="price" style="font-weight: bold;">@item.TongCong</span><span style="font-weight: bold;">đ</span></div>
                                            </div>
                                        </div>
                                        <div class="col-md-5 col-lg-5 col-xl-5 d-flex align-items-center col-imgorder-admin">
                                            <div class="form-row row-cols-1">
                                                @if (item.TinhTrang == null)
                                                {
                                                    <div class="col"><span>Tình trạng:&nbsp;</span><span style="font-weight: bold;color: rgb(239,0,0);">Đang xác nhận</span></div>
                                                }
                                                else
                                                {
                                                    <div class="col"><span>Tình trạng:&nbsp;</span><span style="font-weight: bold;color: rgb(239,0,0);">@item.TinhTrang</span></div>
                                                }
                                                <div class="col"><span>Số điện thoại: <strong>@item.TaiKhoan.SDT</strong></span></div>
                                                <div class="col"><span>Địa chỉ: <strong>@item.TaiKhoan.SoNha / @item.TaiKhoan.Phuong / @item.TaiKhoan.Quan / @item.TaiKhoan.ThanhPho</strong></span></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-2 col-xl-1 d-flex d-xl-flex justify-content-center align-items-center justify-content-xl-center align-items-xl-center btn-hover-green" style="cursor: pointer;padding-bottom: 10px;padding-top: 10px;"><i class="fas fa-pencil-ruler" style="color: rgb(255,255,255);font-size: 30px;"></i></div>
                            </div>
                        </div>
                    }

                </div>
            </form>
        </div>
    </div>
</section>
<div class="nav-account-mob" style="position: fixed;top: 0;width: 0px;z-index: 1000;height: 100%;overflow: hidden;transition: .5s;">
    <div style="position: absolute;width: 100%;height: 100%;" onclick="showNavAccount()"></div>
    <div class="row row-cols-1 text-nowrap main-menumobile" style="background: rgb(255,255,255);overflow: hidden;padding-bottom: 150px;height: 100%;">
        <div class="col" style="padding: 0px;padding-top: 15px;padding-left: 15px;">
            <ul class="list-inline">
                @if (token != null)
                {
                    <li class="list-inline-item d-block" style="padding-left: 15px;padding-bottom: 5px;padding-top: 5px;width: 100%;"><a class="txt-scale-menu" href="/account/userprofile?user=@token.ToString()"><i class="fas fa-user" style="padding-right: 10px;width: 70px;"></i><span>Tài khoản</span></a></li>
                }
                else
                {
                    <li class="list-inline-item d-block" style="padding-left: 15px;padding-bottom: 5px;padding-top: 5px;width: 100%;"><a class="txt-scale-menu" href="/account"><i class="fas fa-user" style="padding-right: 10px;width: 70px;"></i><span>Tài khoản</span></a></li>
                }
                <li class="list-inline-item d-block" style="padding-left: 15px;padding-bottom: 5px;padding-top: 5px;width: 100%;"><a class="txt-scale-menu" href="#"><i class="fas fa-clipboard-check" style="padding-right: 10px;width: 70px;"></i><span>Đơn hàng</span></a></li>
                @if (user.Admin == true)
                {
                    <li class="list-inline-item d-block" style="padding-left: 15px;padding-bottom: 5px;padding-top: 5px;width: 100%;"><a class="txt-scale-menu" href="/admin"><i class="far fa-chart-bar" style="padding-right: 10px;width: 70px;"></i><span>Quản lý</span></a></li>
                }
                <li class="list-inline-item d-block" style="padding-left: 15px;padding-bottom: 5px;padding-top: 5px;width: 100%;"><a class="txt-scale-menu" href="/account/logout"><i class="fas fa-long-arrow-alt-left" style="padding-right: 10px;width: 70px;"></i><span>Đăng xuất</span></a></li>
            </ul>
        </div>
    </div>
</div>
